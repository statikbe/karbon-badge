!function(){const n="https://karbon.statik.be/api/v1/carbon",e=864e5,t="karbon-badge",r="karbon_",a=n=>document.getElementById(n),o=()=>encodeURIComponent(window.location.href),i=()=>r+o();let s=a(t);const d=async(e=!0)=>{try{const t=await fetch(`${n}?url=${o()}`);if(!t.ok)throw new Error(`API error: ${t.status}`);const r=await t.json();e&&c(r.data);const a={...r.data,cachedAt:Date.now()};localStorage.setItem(i(),JSON.stringify(a))}catch(t){console.error("Karbon badge error:",t),a("karbon-result").innerHTML="Data unavailable",localStorage.removeItem(i())}},c=n=>{s.innerHTML=((n,e)=>{try{const t=`\n        with (data) {\n          return \`${n.replace(/&gt;/g,">")}\`;\n        }\n      `;return new Function("data",t)(e)}catch(t){return console.error("Error evaluating JS template:",t),""}})(l,n);const e=document.querySelector('a[href="https://karbon.statik.be"]');e&&"Karbon"===e.textContent.trim()||(console.warn("Karbon badge link not found. Please ensure the link to karbon.statik.be is present for proper attribution."),s.remove())};let l='\n    <div class="karbon-container">\n        ${\n          data.co2_grams\n            ? `<span id="karbon-result">${data.co2_grams}g of CO<sub>2</sub></span\n        >`\n            : \'<span id="karbon-no-result">Measuring CO<sub>2</sub>&hellip;</span>\'\n        }\n        <a id="karbon-link" href="https://karbon.statik.be" target="_blank" rel="noopener">Karbon</a>\n      </div>\n      <div id="karbon-rating">Rating: <strong>${data.co2_rating}</strong></div>\n  ';const b=()=>{if(!("fetch"in window))return void console.warn("Karbon badge requires fetch API support");if(!s)return void console.warn(`Karbon badge container #${t} not found`);s.hasAttribute("data-custom-style")||s.insertAdjacentHTML("afterend","<style>\n        #karbon-badge {\n          font-family: -apple-system, BlinkMacSystemFont, sans-serif;\n          font-size: 14px;\n          text-align: center;\n          line-height: 1;\n        }\n\n        #karbon-badge sub {\n          vertical-align: middle;\n          font-size: 1rem;\n        }\n\n        .karbon-container {\n          display: flex;\n          border-radius: 0.25rem;\n          overflow: hidden;\n          box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n        }\n\n        #karbon-result {\n          flex-grow: 1;\n          border-top-left-radius: 0.25rem;\n          border-bottom-left-radius: 0.25rem;\n          padding: 0.5rem 1rem;\n          background: #ffffff;\n          border: 2px solid #02875a;\n          border-right: none;\n          min-width: 10em;\n        }\n\n        #karbon-link {\n          padding: 0.5em 1em;\n          background: #02875a;\n          color: #ffffff;\n          text-decoration: none;\n          font-weight: 600;\n          border: 2px solid #02875a;\n        }\n\n        #karbon-rating {\n          text-align: center;\n          font-size: 0.8rem;\n          margin-top: 0.25rem;\n        }\n        </style>"),"template"===s.tagName.toLowerCase()&&(l=s.innerHTML,s.insertAdjacentHTML("afterend",`<div id="${t}"></div>`),s.remove(),s=a(t));const n=localStorage.getItem(i()),r=Date.now();if(n)try{const t=JSON.parse(n);c(t),r-t.cachedAt>e&&d(!1)}catch(o){console.error("Error parsing cached data:",o),d()}else d()};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",b):b()}();
